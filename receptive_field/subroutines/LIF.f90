	SUBROUTINE lif()
	USE PARAMETERS
	USE VARIABLES
	USE IFPORT
	IMPLICIT NONE
	INTEGER		::	i
!======================== resetting spike variable to NO spike ============================!
	spk_post = .FALSE.
!============= calculation of membrane potential if not in refrac period ==================!
	IF((tr-spkt_post).GT.pr(3)) THEN
	!-------------------------- NMDA gating variable ------------------------------------------!
		x(8) = 1.0d0/(1.0d0+pr(38)*EXP(pr(39)*x(1)))
	!------------------------------------------------------------------------------------------!
	!---------------------------- total conductance -------------------------------------------!
		x(21) = 1.0d0 + x(3) + x(6)*x(8) + x(4) + x(2)*pr(7)
	!------------------------------------------------------------------------------------------!
	!------------------------------- u infinity -----------------------------------------------!
		x(22) = ( pr(2) + x(4)*pr(32) + x(2)*pr(7)*pr(6) )/x(21)
	!------------------------------------------------------------------------------------------!
	!---------------------------- e^(-dt/tau effective) ---------------------------------------!
		x(23) = pr(1)/x(21)
		x(23) = DEXP(-1.0d0*dt/x(23))
	!------------------------------------------------------------------------------------------!
	!------------------------------- membrane potential ---------------------------------------!
		x(1) = x(1)*x(23) + x(22)*(1.0d0-x(23))
	!------------------------------------------------------------------------------------------!
	!------------------------------- action potential -----------------------------------------!
		IF(x(1).GE.pr(4)) THEN
			spkt_post = tr			!spike timing
			spk_post = .TRUE.		!spike
			x(1) = pr(9)			!reset
			x(2) = x(2) + 1.0d0		!AHP conductance increase
			x(20) = x(20) + 1.0d0		!for firing-rate plot
		END IF
	!------------------------------------------------------------------------------------------!
	END IF
!==========================================================================================!
!=========================== update of synaptic conductances ==============================!
	!decay of AHP conductance
	x(2) = x(2)*pr(10)
	!decay of AMPA conductance
	x(3) = x(3)*pr(35)
	!decay of GABA_A conductance
	x(4) = x(4)*pr(36)
	!decay of NMDA conductance
	x(6) = x(6)*pr(37)
!==========================================================================================!
!========================== codependent plasticvity variables =============================!
	!E
	x(18) = x(18)*p_plast(31) - x(6)*x(8)*x(1)*p_plast(32)
	!I
	x(19) = x(19)*p_plast(34) + x(4)*(x(1)-pr(32))*p_plast(35)
	!E-alpha*I
	x(17) = p_plast(26)*(x(18)*(x(18) - x(19)*p_plast(25)))
!==========================================================================================!
	END SUBROUTINE
