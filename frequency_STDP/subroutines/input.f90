!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!                  INPUT FROM TWO EXTERNAL NEURONS                           !!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	SUBROUTINE input_ext()
	USE IFPORT
	USE PARAMETERS
	USE VARIABLES
	IMPLICIT NONE
!======================== GENERATE SPIKES FROM RATE PROPABILITIES =========================!
!---------------------------- excitatory synapses  ----------------------------------------!
	IF(rand().LT.p_inp(2)) THEN
		x(3) = x(3) + p_con(17)						!AMPA
		x(6) = x(6) + p_con(17)						!NMDA
	END IF
!------------------------------------------------------------------------------------------!
!---------------------------- inhibitory synapses  ----------------------------------------!
	IF(rand().LT.p_inp(3)) THEN
		x(4) = x(4) + p_con(7)						!GABA_A
	END IF
!------------------------------------------------------------------------------------------!
!==========================================================================================!
	END SUBROUTINE
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!                  POST-BEFORE-PRE SPIKING PROTOCOL                          !!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	SUBROUTINE input_post_pre(t)
	USE IFPORT
	USE PARAMETERS
	USE VARIABLES
	IMPLICIT NONE
	INTEGER		::	t
!-------------------------- resetting presynaptic spikes variables ------------------------!
	spk = .FALSE.
!------------------------------------------------------------------------------------------!
!======================== GENERATE PRE SPIKES FROM PROTOCOL ===============================!
	IF(MOD(t,period).EQ.0.0d0) THEN
		spk = .TRUE.
		x(3) = x(3) + msynw
		x(6) = x(6) + msynw
	END IF
!==========================================================================================!
!======================== GENERATE POST CURRENTS FROM PROTOCOL ============================!
	IF(MOD(t+p_sim_int(4),period).EQ.0.0d0) x(10) = 0.0d0
	IF(MOD(t+p_sim_int(5),period).EQ.0.0d0) x(10) = p_inp(11)
!==========================================================================================!
	END SUBROUTINE
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!                  PRE-BEFORE-POST SPIKING PROTOCOL                          !!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	SUBROUTINE input_pre_post(t)
	USE IFPORT
	USE PARAMETERS
	USE VARIABLES
	IMPLICIT NONE
	INTEGER		::	t
!-------------------------- resetting presynaptic spikes variables ------------------------!
	spk = .FALSE.
!------------------------------------------------------------------------------------------!
!======================== GENERATE PRE SPIKES FROM PROTOCOL ===============================!
	IF(MOD(t+2*p_sim_int(4),period).EQ.0.0d0) THEN
		spk = .TRUE.
		x(3) = x(3) + msynw
		x(6) = x(6) + msynw
	END IF
!==========================================================================================!
!======================== GENERATE POST CURRENTS FROM PROTOCOL ============================!
	IF(MOD(t+p_sim_int(4),period).EQ.0.0d0) x(10) = 0.0d0
	IF(MOD(t+p_sim_int(5),period).EQ.0.0d0) x(10) = p_inp(11)
!==========================================================================================!
	END SUBROUTINE
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
